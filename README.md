# èˆèŒæˆç»©æ•°æ®æ¸²æŸ“

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ **FastAPI + Jinja2 æ¨¡æ¿å¼•æ“** æ„å»ºçš„ Web æœåŠ¡ï¼Œç”¨äºå°†æäº¤çš„èˆèŒæˆç»©æ•°æ®æ¸²æŸ“ä¸ºç½‘é¡µã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

.
â”œâ”€â”€ main.py                          # ä¸»ç¨‹åºå…¥å£ï¼ˆFastAPI æœåŠ¡ç«¯ï¼‰
â”œâ”€â”€ client.py                        # å®¢æˆ·ç«¯ç¤ºä¾‹è„šæœ¬
â”œâ”€â”€ format_covers.py                 # æ›²ç»˜æ–‡ä»¶åæ ¼å¼åŒ–å·¥å…·
â”œâ”€â”€ client_data/                     # å®¢æˆ·ç«¯ä½¿ç”¨çš„æµ‹è¯•æ•°æ®ï¼ˆJSONï¼‰
â”‚   â””â”€â”€ ...                          # json æ•°æ®
â”œâ”€â”€ src/                             # æ ¸å¿ƒåº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ routers/                     # è·¯ç”±æ¨¡å—ï¼ˆFastAPI è·¯ç”±æŒ‰åŠŸèƒ½æ‹†åˆ†ï¼‰
â”‚   â”‚   â”œâ”€â”€ b50.py                   # b50 å±•ç¤ºæ¥å£
â”‚   â”‚   â”œâ”€â”€ music_data.py            # æ›²ç›®ä¿¡æ¯æ¥å£
â”‚   â”‚   â”œâ”€â”€ scores_list.py           # æˆç»©åˆ—è¡¨æ¥å£
â”‚   â”‚   â””â”€â”€ table.py                 # å®šæ•°è¡¨ä¸å®Œæˆè¡¨æ¥å£
â”‚   â”œâ”€â”€ web/                         # å‰ç«¯èµ„æºæ¨¡å—ï¼ˆæ¨¡æ¿ + é™æ€èµ„æºï¼‰
â”‚   â”‚   â”œâ”€â”€ templates/               # Jinja2 æ¨¡æ¿ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ b50.html             # b50 é¡µé¢æ¨¡æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ music_data.html      # æ›²ç›®ä¿¡æ¯é¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ scores_list.html     # åˆ†æ•°åˆ—è¡¨é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ table.html           # å®šæ•°è¡¨/å®Œæˆè¡¨é¡µé¢
â”‚   â”‚   â””â”€â”€ static/                  # é™æ€èµ„æºç›®å½•
â”‚   â”‚       â”œâ”€â”€ img/                 # å›¾ç‰‡èµ„æº
â”‚   â”‚       â””â”€â”€ ...                  # å­—ä½“ã€css ç­‰èµ„æº
â”‚   â”œâ”€â”€ config.py                    # é…ç½®é¡¹æ¨¡å—ï¼ˆå¦‚å¸¸é‡ã€è·¯å¾„ï¼‰
â”‚   â”œâ”€â”€ models.py                    # Pydantic æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â””â”€â”€ utils.py                     # å·¥å…·å‡½æ•°é›†åˆ
â”œâ”€â”€ requirements.txt                 # é¡¹ç›®ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md                        # é¡¹ç›®è¯´æ˜æ–‡æ¡£


## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. å¯åŠ¨æœåŠ¡

```bash
python main.py
```

é»˜è®¤è¿è¡Œåœ¨ `http://127.0.0.1:13004`

## âœ… æ¥å£è¯´æ˜

### 1. POST `/`

ç”¨äºæäº¤ç”¨æˆ·ä¿¡æ¯ä¸æˆç»©æ•°æ®ï¼Œéšåå¯åœ¨é¡µé¢æŸ¥çœ‹æ¸²æŸ“ç»“æœã€‚

è¯·æ±‚ä½“ç»“æ„ï¼ˆJSONï¼‰è§ client.py å’Œ src/model.py


### 2. GET `/b50` `/music_data` `/scores_list` `/table`

æ¸²æŸ“æœ€è¿‘æäº¤çš„æˆç»©é¡µé¢ï¼Œå…·ä½“å±•ç¤ºå¯ç”±æ¨¡æ¿å†³å®šã€‚

## ğŸ§ª å®¢æˆ·ç«¯ç¤ºä¾‹

é€šè¿‡è¿è¡Œå®¢æˆ·ç«¯ç¨‹åº client.pyï¼Œå¯è‡ªåŠ¨è¯»å–æœ¬åœ°çš„ json æ–‡ä»¶ï¼Œæ„é€ å¹¶å‘é€ POST è¯·æ±‚ï¼š

```bash
python client.py
```

### æˆç»©æ•°æ®æ¥æºäº [maimai_py](https://maimai.turou.fun/)

### ç»èµæ•°é‡æ•°æ®æ¥æºäº [SimaiChartMiner](https://github.com/Choimoe/SimaiChartMiner/)

## ğŸ¨ é™æ€èµ„æºè¯´æ˜

### åº”åŒ…å«ä»¥ä¸‹èµ„æºï¼š

| ç±»å‹         | æ–‡ä»¶è·¯å¾„ç¤ºä¾‹                                |
| ------------ | ------------------------------------------- |
| æ›²ç»˜         | `/src/web/static/img/covers/*`                      |
| ç”¨æˆ·å¤´åƒ     | `/src/web/static/img/icon/UI_Icon_000001.png`       |
| ç§°å·æ¡†       | `/src/web/static/img/nameplate/UI_Plate_000000.png` |
| å…¶ä»– UI å›¾æ ‡ | `/src/web/static/img/ui/*`                          |

æ›²ç»˜æ–‡ä»¶ä½¿ç”¨ [nonebot-plugin-maimaidx](https://github.com/Yuri-YuzuChaN/nonebot-plugin-maimaidx) é¡¹ç›®çš„é™æ€èµ„æºç´ æ

æ›²ç»˜æ–‡ä»¶å¤¹æ”¾å…¥ `/src/web/static/img/` åï¼Œè¿è¡Œ `format_covers.py` å¯å¯¹æ–‡ä»¶åè¿›è¡Œæ ¼å¼åŒ–

## âš ï¸ æ³¨æ„äº‹é¡¹

1. é¡¹ç›®ä½¿ç”¨å…¨å±€å˜é‡ç¼“å­˜æœ€åä¸€æ¬¡ POST æ•°æ®ï¼ŒæœªæŒä¹…åŒ–ï¼Œä»…æ¼”ç¤ºç”¨é€”ï¼›
2. é¡µé¢æ¨¡æ¿æ–‡ä»¶ä½äº `/src/web/templates/` ç›®å½•ä¸‹ï¼Œå¯è‡ªè¡Œè®¾è®¡æˆ–ä¿®æ”¹ï¼›
3. æ‰€æœ‰å›¾ç‰‡éœ€æ”¾åœ¨ `/src/web/static/img/` å­ç›®å½•ä¸­ï¼Œè·¯å¾„éœ€ä¿æŒä¸€è‡´ï¼›
4. `user.icon` å’Œ `user.nameplate` è‹¥è‡ªå®šä¹‰åˆ™åº”åŒ…å«å®Œæ•´æ–‡ä»¶åï¼Œå…·ä½“è§ client.py ï¼›
5. `music_data.json` ä¸­é¡»åŒ…å«æ‰€æœ‰å‡ºç°åœ¨æˆç»©ä¸­çš„æ­Œæ›²ä¿¡æ¯ã€‚
6. `all.json` ä¸­é¡»åŒ…å«æ‰€æœ‰å‡ºç°åœ¨æˆç»©ä¸­çš„ç»èµä¿¡æ¯ã€‚

## ğŸ“„ é¡¹ç›®å‚è€ƒ

æ•°æ®æ¥æºï¼š[maimai_py](https://maimai.turou.fun/)

æ ·å¼å‚è€ƒï¼š[nonebot-plugin-maimaidx](https://github.com/Yuri-YuzuChaN/nonebot-plugin-maimaidx)

æ€è·¯å‚è€ƒï¼š[maimaiDX_yang](https://github.com/Dale2003/maimaiDX_yang)

## License

MIT License
